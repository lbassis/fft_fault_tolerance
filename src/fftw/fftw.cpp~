#include <iostream>
#include <cmath>
#include <fftw3.h>
#include <cstdlib>
#include <fstream>


using namespace std;

fftw_complex *read_in(fftw_complex *input, char *filename) {

  string line;
  ifstream file (filename);
  int width, height, size;

  input = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * 4);

  if (file.is_open())
  {
    getline(file, line);
    width = atoi(line.c_str());
    getline(file, line);
    height = atoi(line.c_str());

    size = width*height;

    fftw_complex current;
    int position = 0;

    while (getline(file,line)) {
      input[position][0] = atof(line.c_str());
      input[position][1] = 0;
      position++;
    }
    file.close();
    return input;
  }
}


int main(int argc, char *argv[]) {
  
  fftw_complex *in, *out;
  fftw_plan p;

  in = read_in(in, argv[1]);
  out = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * sizeof(in));
  
  p = fftw_plan_dft_1d(4, in, out, FFTW_FORWARD, FFTW_ESTIMATE);
  fftw_execute(p);

  ofstream output;
  output.open(argv[2]);
  for (int i = 0; i < sizeof(in)/2; i++) {
    if (out[i][1] >= 0)
      output << out[i][0] << "+" << out[i][1] << "j" << endl;
    else
      output << out[i][0]  << out[i][1] << "j" << endl;
  }
    output.close();

  
  fftw_destroy_plan(p);
  fftw_free(in);
  fftw_free(out);

  return 0;
}
